{"version":3,"sources":["app/poms_05_addcompany_20230907.cljc"],"mappings":";AAUA,AACA,AA2BA","names":[],"sourcesContent":["(ns app.poms-05-addcompany-20230907\n  (:require contrib.str\n            [hyperfiddle.electric :as e]\n            [hyperfiddle.electric-dom2 :as dom]\n    ;datomic require'\u0131 asag\u0131daki\n            #?(:clj [datomic.client.api :as d])\n            [hyperfiddle.electric-ui4 :as ui]\n            ))\n\n;; bu k\u0131s\u0131mda zorunlu\n(e/def conn)\n(e/def db)\n;; bu k\u0131s\u0131mda zorunlu\n\n\n#?(:clj (defn get-free-company-id [db] (if (empty? (d/q\n                                                     '[:find ?e\n                                                       :where\n                                                       [_ :company/id ?e]]\n                                                     db)\n                                                   )\n                                         1\n                                         (+ 1 (ffirst (take 1 (reverse (->> (d/q\n                                                                              '[:find ?e\n                                                                                :where\n                                                                                [_ :company/id ?e]]\n                                                                              db)\n                                                                            (sort-by last)\n                                                                            )\n                                                                       )\n                                                            )\n                                                      )\n                                            )\n                                         )\n          )\n   )\n\n\n(e/defn add-company []\n        (e/server\n          (binding [conn @(requiring-resolve 'user/datomic-conn)]\n            (binding [db (d/db conn)]\n              ;bind etmek zorunday\u0131z dbyi cal\u0131st\u0131rmak i\u00e7in.\n              (e/client\n                (let [!state (atom {\n                                    :brand-name      \"\"\n                                    :email           \"\"\n                                    :phonenumber     \"\"\n                                    :category        \"\"\n                                    :btn1-is-clicked false\n                                    :login-info      \"Welcome! Colabio makes life easier...\"\n                                    :free-comp-id    (e/server\n                                                       (binding [conn @(requiring-resolve 'user/datomic-conn)]\n                                                         (binding [db (d/db conn)]\n                                                           (get-free-company-id db)\n                                                           )\n                                                         )\n                                                       )\n                                    })\n                      btn-state (get (e/watch !state) :btn1-is-clicked)\n                      login-info (get (e/watch !state) :login-info)\n                      category (get (e/watch !state) :category)\n                      brand-name (get (e/watch !state) :brand-name)\n                      email (get (e/watch !state) :email)\n                      phonenumber (get (e/watch !state) :phonenumber)\n                      company-id (get (e/watch !state) :free-comp-id)\n                      ]\n                  (dom/element \"style\" (dom/text \"\n                  ul{list-style-type: none; margin: 0; padding: 0; background-color: black; overflow: auto; }\n                  li {float: left;}\n                  li a {color: white; padding: 15px 25px; display: inline-block; text-align: center; text-decoration: none;}\n                  .home {background-color: darkred;}\n                  li a:hover {\n                  background-color: #405d27;\n                  label {font-size: 16px; margin-right: 10px;}\n                  select {font-size: 14px;padding: 5px;border: 1px solid #ccc;border-radius: 4px;}\n                  }\n                  \"))\n                  (dom/ul (dom/props {:class \"ul\"})\n                          (dom/li\n                            (dom/a (dom/props {:class \"home\" :href \"http://localhost:8080/\"})\n                                   (dom/text \"Home\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-00-signup-20230831!signup-page)\"})\n                                   (dom/text \"Sign Up\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-01-login-20230828!login-page)\"})\n                                   (dom/text \"Log In\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-02-cp-20230830!create-project)\"})\n                                   (dom/text \"Create Project\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-03-crfp-20230906!create-rfp)\"})\n                                   (dom/text \"Create Rfp\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-04-sif-20230907!sif-page)\"})\n                                   (dom/text \"Supplier Information Screen\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-05-addcompany-20230907!add-company)\"})\n                                   (dom/text \"Add New Company\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-06-ph-20230915!ph-page)\"})\n                                   (dom/text \"Project Highlights\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-07-app-20230915!app-page)\"})\n                                   (dom/text \"Add New Proposal\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-08-ap-20230918!approve-proposal)\"})\n                                   (dom/text \"Approve Proposal\")))\n                          (dom/li\n                            (dom/a (dom/props {:href \"http://localhost:8080/(app.poms-09-ot-20230920!operation-track-page)\"})\n                                   (dom/text \"Operation Track\")))\n                          )\n\n                  (dom/div\n                    (dom/form\n                      (dom/props {:class \"form\"\n                                  :il    \"FORM\"\n                                  })\n                      (dom/fieldset\n                        (dom/props {:name \"FORM\"\n                                    })\n                        (dom/legend\n                          (dom/text \"Add New Company\")\n                          (dom/props {:style {:text-align \"center\"}}))\n\n                        (dom/label (dom/props {:for \"dropdown\"}) (dom/text \"lutfen \u015firket categorisini se\u00e7in:\" (dom/props {:style {:font-style \"none\"}})))\n                        (dom/select (dom/props {:id \"dropdown\"})\n                                    (dom/option (dom/props {:disabled \"true\" :selected \"false\"})\n                                                (dom/text \"\"))\n                                    (dom/option (dom/props {:value \"bilgisayar\"})\n                                                (dom/text \"Bilgisayar\"))\n                                    (dom/option (dom/props {:value \"seyahat\"})\n                                                (dom/text \"Seyahat\"))\n                                    (dom/option (dom/props {:value \"konaklama\"})\n                                                (dom/text \"Konaklama\"))\n                                    (dom/on \"change\" (fn [] (swap! !state assoc :category (keyword \"service\" (str (.-value dom/node))))))\n                                    )\n\n                        (dom/p (dom/text \"Brand Name:\" (dom/props {:class \"text\"\n                                                                   }))\n                               (ui/input brand-name\n                                         (e/fn [v] (swap! !state assoc :brand-name v))\n                                         (dom/props {:style {:name \"brand-name\"}})\n                                         ))\n                        (dom/p (dom/text \"Email:\" (dom/props {:class \"text\"\n                                                              }))\n                               (ui/input email\n                                         (e/fn [v] (swap! !state assoc :email v))\n                                         (dom/props {:style {:name \"email\"}})\n                                         ))\n                        (dom/p (dom/text \"Contact No:\" (dom/props {:class \"text\"\n                                                                   }))\n                               (ui/input phonenumber\n                                         (e/fn [v] (swap! !state assoc :phonenumber v))\n                                         (dom/props {:style {:name \"Contact No:\"}})\n                                         ))\n\n\n\n                        (ui/button\n                          (e/fn []\n                                (e/server (d/transact conn {:tx-data [{:company/id          (e/server\n                                                                                              (binding [conn @(requiring-resolve 'user/datomic-conn)]\n                                                                                                (binding [db (d/db conn)]\n                                                                                                  (get-free-company-id db)\n                                                                                                  )\n                                                                                                )\n                                                                                              )\n                                                                       :company/brand-name  brand-name\n                                                                       :company/email       email\n                                                                       :company/phonenumber phonenumber\n                                                                       :company/category    [category]\n                                                                       }\n                                                                      ]})\n                                          )\n\n                                )\n                          (dom/on \"click\" (fn [] (swap! !state assoc :btn1-is-clicked true)))\n                          (dom/text \"Add Comp\")\n                          (dom/props {:type  \"button\"\n                                      :class \"create-project\"\n                                      :name  \"signup-button\"\n                                      :style {:text-align \"center\" :margin-left \"50px\"}\n                                      })\n                          )\n\n                        (if btn-state\n                          (case (clojure.string/blank? (e/server\n                                                         (binding [conn @(requiring-resolve 'user/datomic-conn)]\n                                                           (binding [db (d/db conn)]\n                                                             (ffirst (d/q\n                                                                       '[:find ?e\n                                                                         :in $ ?id\n                                                                         :where\n                                                                         [?e :company/id ?id]]\n                                                                       db company-id))\n                                                             )\n                                                           )\n                                                         )\n                                                       )\n                            false (\n                                   (swap! !state assoc :free-comp-id (e/server\n                                                                       (binding [conn @(requiring-resolve 'user/datomic-conn)]\n                                                                         (binding [db (d/db conn)]\n                                                                           (get-free-company-id db)\n                                                                           )\n                                                                         )\n                                                                       )\n                                          )\n                                   (swap! !state assoc :login-info \"Company is adding...\")\n                                   (swap! !state assoc :btn1-is-clicked false)\n                                   (.setTimeout js/window #(swap! !state assoc :login-info \"New Supplier Company Added!\") 1000)\n                                   (swap! !state assoc :brand-name \"\")\n                                   (swap! !state assoc :email \"\")\n                                   (swap! !state assoc :phonenumber \"\")\n                                   )\n                            true ((swap! !state assoc :login-info \"Something Went Wrong!!\")\n                                  (swap! !state assoc :btn1-is-clicked false))\n                            )\n                          )\n\n                        (dom/p (dom/text login-info\n                                         (dom/props {:class      \"login-info\"\n                                                     :name       \"login-text\"\n                                                     :text-align \"center\"\n                                                     })))\n\n                        )\n                      )\n                    )\n                  )\n                )\n              )\n            )\n          )\n        )\n\n"]}